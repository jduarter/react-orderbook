# File generated by gflows, do not modify
# Source: react-native-vercel-deploy/workflows/react-native-vercel-deploy
name: react-native-vercel-deploy
"on":
  pull_request:
    branches:
    - develop
  push:
    branches:
    - main
    - develop
    - master
jobs:
  deploy:
    name: RN Deploy to Vercel (as web)
    environment: defaultEnv
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: read
    strategy:
      fail-fast: true
      matrix:
        language:
        - javascript
    steps:
    - name: gflows check
      uses: jbrunton/setup-gflows@v1
    - name: Checkout repository
      uses: actions/checkout@v2
    - name: Install dependencies using npm
      run: |
        npm install
    - name: Run npm run typescript
      run: |
        npm run typescript
    - name: Run npm test
      run: |
        npm test
    - name: Convert to expo project
      run: |
        npx expoize
    - name: Run expo-optimize
      run: |
        npx expo-optimize
    - name: Run expo build for web
      run: |
        npx expo build:web
    - name: Vercel Action
      uses: amondnet/vercel-action@v20.0.0
      with:
        vercel-args: -c -C
        working-directory: ./web-build
        alias-domains: orderbookjd-{{BRANCH}}-jduarter
        vercel-project-name: orderbookjd
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
